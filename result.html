<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生成完了 | つむぐね</title>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <header>
        <div class="container nav">
            <a href="./index.html" class="logo">つむぐね</a>
        </div>
    </header>

    <main class="section">
        <div class="container">
            <div style="max-width: 800px; margin: 0 auto;">
                <p class="brand-accent text-center">Your Masterpiece</p>
                <h1 class="text-center mb-lg">生成された作品</h1>

                <div style="display: grid; grid-template-columns: 1.2fr 1fr; gap: var(--spacing-lg); align-items: stretch;"
                    id="res-grid">
                    <style>
                        @media (max-width: 768px) {
                            #res-grid {
                                grid-template-columns: 1fr !important;
                            }
                        }
                    </style>
                    <!-- Result Visual -->
                    <div class="card" style="padding: 0; overflow: hidden; display: flex; flex-direction: column;">
                        <div id="final-visual"
                            style="flex-grow: 1; background: #FFF; aspect-ratio: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative;">
                            <div class="waveform-container" style="margin-bottom: var(--spacing-md);">
                                <div class="wave-bar" style="height: 40px; animation: none;"></div>
                                <div class="wave-bar" style="height: 60px; animation: none;"></div>
                                <div class="wave-bar" style="height: 30px; animation: none;"></div>
                                <div class="wave-bar" style="height: 80px; animation: none;"></div>
                                <div class="wave-bar" style="height: 50px; animation: none;"></div>
                            </div>
                            <p id="display-text" class="serif-font"
                                style="font-size: 1.8rem; letter-spacing: 0.2em; text-transform: uppercase;"></p>
                        </div>
                    </div>

                    <!-- Order Sidebar -->
                    <div class="card" style="background: var(--bg-color);">
                        <h3 class="serif-font mb-sm">ご注文内容 <span class="text-xs">Order Summary</span></h3>
                        <div
                            style="border-bottom: 1px solid #EEE; padding-bottom: var(--spacing-sm); margin-bottom: var(--spacing-md);">
                            <p class="text-sm" id="summary-item">商品: Loading...</p>
                            <p class="text-sm" id="summary-size">サイズ: Loading...</p>
                            <p class="text-sm" id="summary-color">本体色: Loading...</p>
                            <p class="text-sm" id="summary-thread" style="color: var(--amber-gold);">糸の色: AI選定完了</p>
                        </div>

                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
                            <span class="text-sm">合計金額</span>
                            <span id="summary-price" class="serif-font" style="font-size: 1.5rem;">¥0,000</span>
                        </div>

                        <h3 class="serif-font mb-sm" style="font-size: 1rem;">配送先情報 <span
                                class="text-xs">Shipping</span>
                        </h3>
                        <input type="text" placeholder="お名前"
                            style="width: 100%; padding: 12px; margin-bottom: 8px; border: 1px solid #EEE; border-radius: 8px;">
                        <input type="text" placeholder="郵便番号"
                            style="width: 100%; padding: 12px; margin-bottom: 8px; border: 1px solid #EEE; border-radius: 8px;">
                        <textarea placeholder="ご住所" rows="3"
                            style="width: 100%; padding: 12px; margin-bottom: var(--spacing-md); border: 1px solid #EEE; border-radius: 8px;"></textarea>

                        <button onclick="checkout()" class="btn btn-primary" style="width: 100%;">購入を確定する</button>
                        <p class="text-center mt-sm" style="font-size: 0.7rem; color: var(--text-muted);">
                            ※個別会計のため、お一人様ずつの決済となります。
                        </p>
                    </div>
                </div>

                <div class="text-center mt-lg">
                    <a href="./index.html" class="text-sm"
                        style="text-decoration: none; border-bottom: 1px solid var(--text-muted);">注文をキャンセルして戻る</a>
                </div>
            </div>
        </div>
    </main>

    <script>
        window.addEventListener('load', () => {
            const item = JSON.parse(localStorage.getItem('selectedItem'));
            const result = JSON.parse(localStorage.getItem('resultData'));
            if (!item || !result) { window.location.href = './index.html'; return; }
            document.getElementById('display-text').innerText = result.text;
            document.getElementById('summary-item').innerText = `商品: ${item.name}`;
            document.getElementById('summary-size').innerText = `サイズ: ${item.size}`;
            document.getElementById('summary-color').innerText = `本体色: ${item.color}`;
            document.getElementById('summary-thread').innerText = `糸の色: AI選定 (${result.threadColor})`;
            document.getElementById('summary-price').innerText = item.price;
            const bars = document.querySelectorAll('.wave-bar');
            const colorMap = { 'Amber Gold': '#D4AF37', 'Air Blue': '#D1E5F4', 'Dusty Rose': '#E8D5D5' };
            bars.forEach(bar => { bar.style.backgroundColor = colorMap[result.threadColor] || '#D4AF37'; });
        });
        function checkout() {
            alert('ありがとうございます。注文が完了しました。');
            localStorage.clear();
            window.location.href = './index.html';
        }
    </script>
</body>

</html>